(()=>{"use strict";const e=e=>{const t=e;let r=0;const a=()=>t;return{length:a,hit:()=>{r+=1},getHits:()=>r,isSunk:()=>r===a()}},t=t=>{const r=(t,r,a)=>{const o={};for(let s=0;s<r;s++)o[`${a+(s+1)}`]=e(t);return o},a=(()=>{const e=4,t=2,a=3,o=3,s=3,c=4,n=2,u=5;return{...r(5,1,"c"),...r(e,t,"b"),...r(a,o,"d"),...r(s,c,"s"),...r(n,u,"pb")}})(),o=(()=>{const e=(e,t)=>{const r=["empty","ship","miss","hit"];let a="empty",o=null;return{coordinates:[e,t],setShipID:e=>{a="ship",o=e},getShipID:()=>o,updateStatus:()=>{a=a===r[0]?r[2]:r[3]},getStatus:()=>a}};return{adjacencyList:(e,t)=>{const r={};return Object.keys(e).forEach((a=>{r[a]={},r[a].square=e[a],t.forEach((t=>{const o=`${Number(a[0])+Number(t[0])},${Number(a[2])+Number(t[1])}`;e[o]&&(r[a][o]=e[o])}))})),r},defineVertices:()=>{const t={};for(let r=0;r<10;r++)for(let a=0;a<10;a++)t[`${r},${a}`]=e(r,a);return t},moves:[[1,0],[0,1],[-1,0],[0,-1]]}})(),s=o.adjacencyList(o.defineVertices(),o.moves);var c,n;t&&(c=a,n=s,Object.keys(c).forEach((e=>{const t=c[e].length(),r=[[1,0],[0,1],[-1,0],[0,-1]];let a=!1;for(;!a;){const o=Object.keys(n)[Math.floor(Math.random()*Object.keys(n).length)];r.forEach((r=>{if(!a){let s=0;for(let e=0;e<t;e++){const a=r[0]*(t-e),c=r[1]*(t-e),u=`${Number(o[0])+a},${Number(o[2])+c}`;if(!n[u])break;if(n[u].square.getShipID())break;s+=1}if(s===t){for(let a=0;a<t;a++){const s=r[0]*(t-a),c=r[1]*(t-a),u=`${Number(o[0])+s},${Number(o[2])+c}`;n[u].square.setShipID(e)}a=!0}}}))}})));const u=e=>{const t=s[e].square.getStatus();if("ship"===t){s[e].square.updateStatus();const t=s[e].square.getShipID();return a[t].hit(),!0}return"empty"===t&&(s[e].square.updateStatus(),!1)};return{board:s,ships:a,receiveAttack:u,allShipsSunk:()=>{let e=0;return Object.keys(a).forEach((t=>{a[t].isSunk()&&(e+=1)})),15===e},hitAll:()=>{Object.keys(s).forEach((e=>{u(e)}))}}},r=e=>{const t=e;let r=0;const a={},o={};for(let e=0;e<10;e+=1)for(let t=0;t<10;t+=1)o[`${e},${t}`]=!0;return{getPlayer:()=>t,validMove:e=>!!o[e]&&!a[e]&&(a[e]=!0,e),computerMakeMove:()=>{const e=Object.keys(o);let t,r=!1;for(;!r;)t=e[Math.floor(Math.random()*e.length)],a[t]||(a[t]=!0,r=!0);return t},getScore:()=>r,updateScore:()=>{r+=1}}},a=t(!0),o=t(!0),s=r("Player 1"),c=r("Computer"),n=(()=>{const e=document.querySelector(".player-1.score>.score.num"),t=document.querySelector(".player-2.score>.score.num");return{makeBoard:(e,t,r,a)=>{Object.keys(t).forEach((o=>{const s=document.createElement("div");s.classList.add("square"),s.id=r?`p1-${o}`:`p2-${o}`,s.classList.add(o),a&&s.addEventListener("click",(()=>{a(o)})),r&&(t[o].square.getShipID()?(s.classList.add("has-ship"),s.classList.add(`${t[o].square.getShipID()}`)):s.classList.add("no-ship")),e.appendChild(s)}))},player1Board:document.querySelector(".boards>.player-1"),player2Board:document.querySelector(".boards>.player-2"),updateP1Score:t=>{e.textContent=t},updateP2Score:e=>{t.textContent=e},updateBoardCom:(e,t)=>{document.getElementById(`p2-${e}`).classList.add(t)},updateBoardPlayer:(e,t)=>{document.getElementById(`p1-${e}`).classList.add(t)},displayVictory:e=>{const t=document.querySelector(".victory.screen");document.querySelector(".victory.screen .text").textContent=`${e} wins!`,t.classList.toggle("hid")}}})();n.makeBoard(n.player1Board,a.board,!0),n.makeBoard(n.player2Board,o.board,!1,(async e=>{const t=await s.validMove(e);if(t){const e=c.computerMakeMove();o.receiveAttack(t)&&s.updateScore(),o.allShipsSunk()&&n.displayVictory(s.getPlayer()),a.receiveAttack(e)&&c.updateScore(),a.allShipsSunk()&&!o.allShipsSunk()&&n.displayVictory(c.getPlayer()),n.updateP1Score(s.getScore()),n.updateP2Score(c.getScore());const r=await a.board[e].square.getStatus(),u=await o.board[t].square.getStatus();n.updateBoardPlayer(e,r),n.updateBoardCom(t,u)}})),console.log("Gamelup ran")})();